# 英语单词量测试小程序 - 前端架构设计文档

## 1. 项目概述

### 1.1 项目背景
英语单词量测试微信小程序，为用户提供便捷的英语词汇量测试服务，支持多种测试模式、个性化学习建议和社交分享功能。

### 1.2 技术架构
- **开发框架**: 微信小程序原生框架
- **编程语言**: JavaScript/TypeScript
- **样式语言**: WXSS (WeChat Style Sheets)
- **数据存储**: 微信小程序本地存储 + 云数据库
- **网络请求**: wx.request API
- **状态管理**: 页面级状态管理
- **构建工具**: 微信开发者工具

## 2. 项目目录结构

```
english-vocabulary-miniprogram/
├── app.js                          # 小程序入口文件
├── app.json                        # 小程序配置文件
├── app.wxss                        # 全局样式文件
├── project.config.json             # 项目配置文件
├── sitemap.json                    # 站点地图配置
├── package.json                    # 依赖管理文件
├── pages/                          # 页面目录
│   ├── index/                      # 首页
│   ├── test/                       # 测试页面
│   ├── result/                     # 结果页面
│   ├── history/                    # 历史记录
│   ├── profile/                    # 个人中心
│   ├── ranking/                    # 排行榜
│   ├── vocabulary/                 # 词汇库
│   └── settings/                   # 设置页面
├── components/                     # 组件目录
│   ├── common/                     # 通用组件
│   └── business/                   # 业务组件
├── services/                       # 服务目录
│   ├── api/                       # API服务
│   ├── storage/                   # 存储服务
│   ├── utils/                     # 工具服务
│   └── config/                    # 配置服务
├── assets/                        # 资源目录
│   ├── images/                    # 图片资源
│   ├── styles/                    # 样式资源
│   └── data/                      # 数据资源
└── docs/                          # 文档目录
```

## 3. 应用配置

### 3.1 app.json 配置
```json
{
  "pages": [
    "pages/index/index",
    "pages/test/test",
    "pages/result/result",
    "pages/history/history",
    "pages/profile/profile",
    "pages/ranking/ranking",
    "pages/vocabulary/vocabulary",
    "pages/settings/settings"
  ],
  "window": {
    "backgroundTextStyle": "light",
    "navigationBarBackgroundColor": "#667eea",
    "navigationBarTitleText": "英语单词量测试",
    "navigationBarTextStyle": "white",
    "backgroundColor": "#f8f9fa"
  },
  "tabBar": {
    "color": "#999999",
    "selectedColor": "#667eea",
    "backgroundColor": "#ffffff",
    "list": [
      {
        "pagePath": "pages/index/index",
        "text": "首页",
        "iconPath": "assets/images/icons/home.png",
        "selectedIconPath": "assets/images/icons/home-active.png"
      },
      {
        "pagePath": "pages/history/history",
        "text": "历史",
        "iconPath": "assets/images/icons/history.png",
        "selectedIconPath": "assets/images/icons/history-active.png"
      },
      {
        "pagePath": "pages/profile/profile",
        "text": "我的",
        "iconPath": "assets/images/icons/profile.png",
        "selectedIconPath": "assets/images/icons/profile-active.png"
      }
    ]
  }
}
```

## 4. 页面设计

### 4.1 首页 (index)
- 用户信息展示
- 快速开始测试
- 学习统计信息
- 功能导航入口

### 4.2 测试页面 (test)
- 题目展示
- 答题进度
- 时间倒计时
- 选项选择

### 4.3 结果页面 (result)
- 测试结果展示
- 分数统计
- 词汇量评估
- 学习建议

### 4.4 历史记录 (history)
- 测试历史列表
- 成绩趋势图
- 筛选功能
- 详细统计

### 4.5 个人中心 (profile)
- 用户信息管理
- 学习统计
- 设置选项
- 个人成就

### 4.6 排行榜 (ranking)
- 好友排行榜
- 全球排行榜
- 排名变化
- 分享功能

### 4.7 词汇库 (vocabulary)
- 词汇分类
- 搜索功能
- 词汇详情
- 收藏功能

### 4.8 设置页面 (settings)
- 测试参数设置
- 通知设置
- 隐私设置
- 关于我们

## 5. 组件设计

### 5.1 通用组件
- **Loading组件**: 加载状态显示
- **Button组件**: 统一按钮样式
- **Modal组件**: 弹窗组件
- **Progress组件**: 进度条组件

### 5.2 业务组件
- **QuestionCard组件**: 题目卡片
- **ResultChart组件**: 结果图表
- **RankingItem组件**: 排行榜项
- **VocabularyItem组件**: 词汇项

## 6. 服务层设计

### 6.1 API服务
```javascript
// services/api/index.js
class ApiService {
  constructor() {
    this.baseUrl = 'https://api.english-vocabulary.com/api/v1';
  }

  // 用户认证
  login(code, userInfo) {
    return this.request({
      url: '/auth/login/',
      method: 'POST',
      data: { code, user_info: userInfo }
    });
  }

  // 获取测试题目
  getQuestions(config) {
    return this.request({
      url: '/tests/questions/',
      method: 'GET',
      data: config
    });
  }

  // 提交测试答案
  submitTest(data) {
    return this.request({
      url: '/tests/submit/',
      method: 'POST',
      data: data
    });
  }

  // 获取历史记录
  getHistory(params) {
    return this.request({
      url: '/history/',
      method: 'GET',
      data: params
    });
  }

  // 获取排行榜
  getRanking(params) {
    return this.request({
      url: '/ranking/',
      method: 'GET',
      data: params
    });
  }
}
```

### 6.2 存储服务
```javascript
// services/storage/index.js
class StorageService {
  // 设置本地存储
  set(key, value) {
    try {
      wx.setStorageSync(key, value);
      return true;
    } catch (e) {
      console.error('存储失败:', e);
      return false;
    }
  }

  // 获取本地存储
  get(key) {
    try {
      return wx.getStorageSync(key);
    } catch (e) {
      console.error('获取存储失败:', e);
      return null;
    }
  }

  // 删除本地存储
  remove(key) {
    try {
      wx.removeStorageSync(key);
      return true;
    } catch (e) {
      console.error('删除存储失败:', e);
      return false;
    }
  }
}
```

## 7. 样式设计

### 7.1 全局样式变量
```css
/* assets/styles/variables.wxss */
page {
  /* 颜色变量 */
  --primary-color: #667eea;
  --secondary-color: #764ba2;
  --success-color: #28a745;
  --warning-color: #ffc107;
  --danger-color: #dc3545;
  
  /* 文字颜色 */
  --text-primary: #333333;
  --text-secondary: #666666;
  --text-muted: #999999;
  --text-light: #ffffff;
  
  /* 背景颜色 */
  --bg-primary: #ffffff;
  --bg-secondary: #f8f9fa;
  
  /* 间距变量 */
  --spacing-xs: 4rpx;
  --spacing-sm: 8rpx;
  --spacing-md: 16rpx;
  --spacing-lg: 24rpx;
  --spacing-xl: 32rpx;
  
  /* 字体大小 */
  --font-size-xs: 20rpx;
  --font-size-sm: 24rpx;
  --font-size-md: 28rpx;
  --font-size-lg: 32rpx;
  --font-size-xl: 36rpx;
  
  /* 圆角 */
  --border-radius-sm: 8rpx;
  --border-radius-md: 16rpx;
  --border-radius-lg: 24rpx;
  
  /* 阴影 */
  --shadow-sm: 0 2rpx 8rpx rgba(0, 0, 0, 0.1);
  --shadow-md: 0 8rpx 24rpx rgba(0, 0, 0, 0.1);
}
```

## 8. 状态管理

### 8.1 全局状态
```javascript
// app.js 中的 globalData
globalData: {
  userInfo: null,           // 用户信息
  token: null,              // 认证令牌
  testConfig: {             // 测试配置
    type: 'vocabulary',
    difficulty: 'intermediate',
    questionCount: 20
  },
  currentTest: null,        // 当前测试信息
  statistics: {             // 用户统计
    totalTests: 0,
    averageScore: 0,
    vocabularyLevel: 'beginner'
  }
}
```

## 9. 错误处理

### 9.1 全局错误处理
```javascript
// app.js
App({
  onError(error) {
    console.error('小程序错误:', error);
    // 上报错误到服务器
    this.reportError(error);
  },

  onUnhandledRejection(res) {
    console.error('未处理的Promise拒绝:', res.reason);
    this.reportError(res.reason);
  }
});
```

### 9.2 API错误处理
```javascript
// services/api/index.js
handleError(error) {
  let message = '网络请求失败';
  
  if (error.statusCode) {
    switch (error.statusCode) {
      case 401:
        message = '登录已过期，请重新登录';
        this.handleUnauthorized();
        break;
      case 403:
        message = '没有权限访问';
        break;
      case 404:
        message = '请求的资源不存在';
        break;
      case 500:
        message = '服务器内部错误';
        break;
      default:
        message = error.data?.message || '请求失败';
    }
  }
  
  wx.showToast({
    title: message,
    icon: 'none'
  });
}
```

## 10. 性能优化

### 10.1 图片优化
- 使用CDN加速图片加载
- 图片懒加载
- 图片压缩和格式优化

### 10.2 代码优化
- 代码分割和按需加载
- 减少不必要的网络请求
- 优化页面渲染性能

### 10.3 缓存策略
- 本地缓存常用数据
- 合理使用微信小程序缓存API
- 缓存策略优化

## 11. 安全考虑

### 11.1 数据安全
- 敏感数据加密存储
- 网络请求使用HTTPS
- 用户隐私保护

### 11.2 代码安全
- 代码混淆和压缩
- 敏感信息不硬编码
- 权限控制

## 12. 测试策略

### 12.1 单元测试
- 组件功能测试
- 工具函数测试
- API服务测试

### 12.2 集成测试
- 页面功能测试
- 用户流程测试
- 数据流测试

### 12.3 性能测试
- 页面加载性能
- 内存使用情况
- 网络请求性能

## 13. 部署配置

### 13.1 project.config.json
```json
{
  "description": "英语单词量测试小程序",
  "setting": {
    "urlCheck": false,
    "es6": true,
    "enhance": true,
    "postcss": true,
    "minified": true,
    "newFeature": false,
    "coverView": true,
    "nodeModules": false,
    "autoAudits": false,
    "showShadowRootInWxmlPanel": true,
    "scopeDataCheck": false,
    "uglifyFileName": false,
    "checkInvalidKey": true,
    "checkSiteMap": true,
    "uploadWithSourceMap": true,
    "compileHotReLoad": false,
    "useMultiFrameRuntime": true,
    "useApiHook": true,
    "useApiHostProcess": true
  },
  "compileType": "miniprogram",
  "libVersion": "2.19.4",
  "appid": "your-app-id",
  "projectname": "english-vocabulary-miniprogram"
}
```

## 14. 开发规范

### 14.1 命名规范
- **文件命名**: 使用kebab-case
- **变量命名**: 使用camelCase
- **常量命名**: 使用UPPER_SNAKE_CASE
- **组件命名**: 使用PascalCase

### 14.2 代码规范
- 使用ESLint进行代码检查
- 遵循微信小程序开发规范
- 编写清晰的注释和文档

### 14.3 Git提交规范
```
feat: 新功能
fix: 修复bug
docs: 文档更新
style: 代码格式调整
refactor: 代码重构
test: 测试相关
chore: 构建过程或辅助工具的变动
```

## 15. 总结

本架构设计文档详细描述了英语单词量测试小程序前端的技术架构、目录结构、页面设计、组件设计等各个方面。通过采用微信小程序原生框架，结合模块化的设计思想，能够为用户提供流畅、稳定的测试体验。

该架构具有良好的可维护性、可扩展性和性能表现，能够满足项目的功能需求和非功能需求，为用户提供优质的英语词汇量测试服务。 